<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		服务 | 
	 
	Hexo
	</title>
	
	<!-- keywords,description -->
	 

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "https://lixiao-yu.github.io/";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	
<link rel="stylesheet" href="/css/main.css">

	
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">

	
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/styles/darcula.min.css">


	
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.17.1/build/highlight.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

	
<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>

	
<script src="/js/main.js"></script>

	
		
<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>

		
<script src="https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js"></script>

	
	
		<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
	<header id="header">
    <a id="title" href="/" class="logo">Hexo</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">ABOUT</a>
		</li>
		
		<!-- <li class="menu-item">
			<a href="https://github.com/wujun234/uid-generator-spring-boot-starter" class="menu-item-link" target="_blank">
				UidGenerator
			</a>
		</li> -->
		<!-- <li class="menu-item">
			<a href="https://github.com/wujun234" class="menu-item-link" target="_blank">
				<i class="fa fa-github fa-2x"></i>
			</a>
		</li> -->
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle" ><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="按回车全站搜索">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Linux
									</a>
									
							<ul>
								<li class="file active">
									<a href="/2021/01/17/Linux/%E6%9C%8D%E5%8A%A1(systemd)/">
										服务(systemd)
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Linux/%E9%98%B2%E7%81%AB%E5%A2%99(iptables)/">
										防火墙(iptables)
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Mysql
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/01/17/Mysql/Mysql%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8/">
										Mysql索引使用
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Mysql/Mysql%E7%B4%A2%E5%BC%95%E5%AD%98%E5%82%A8/">
										Mysql索引存储
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Mysql/Mysql%E9%94%81/">
										Mysql锁
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Mysql/%E4%BA%8B%E5%8A%A1%E7%9A%84ACID/">
										事务的ACID
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Python
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										cookbook经验总结
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/01/26/Python/cookbook%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/1.%20%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">
										1. 常见数据结构与算法
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/02/25/Python/cookbook%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/3.%20%E6%95%B0%E5%AD%97%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4/">
										3. 数字日期与时间
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/02/25/Python/cookbook%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/4.%20%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/">
										4. 迭代器和生成器
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/02/25/Python/cookbook%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/5.%20%E6%96%87%E4%BB%B6%E4%B8%8EIO/">
										5. 文件与IO
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/02/25/Python/cookbook%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/6.%20%E6%95%B0%E6%8D%AE%E7%BC%96%E7%A0%81%E5%92%8C%E5%A4%84%E7%90%86/">
										6. 数据编码和处理
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/02/25/Python/cookbook%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/7.%20%E5%87%BD%E6%95%B0/">
										7. 函数
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/02/25/Python/cookbook%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/8.%20%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1/">
										8. 类和对象
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Redis
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/01/17/Redis/Redis%E5%8F%82%E6%95%B0/">
										Redis参数
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Shell
									</a>
									
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Shell基础
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%9F%BA%E7%A1%80/1%20%E5%9F%BA%E7%A1%80shell%E5%8F%8A%E5%85%B6%E5%91%BD%E4%BB%A4/">
										1 基础shell及其命令
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%9F%BA%E7%A1%80/1%E5%9F%BA%E7%A1%80shell%E5%8F%8A%E5%85%B6%E5%91%BD%E4%BB%A4/">
										1基础shell及其命令
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%9F%BA%E7%A1%80/2%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/">
										2文件系统
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%9F%BA%E7%A1%80/3shell%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">
										3shell编程基础
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%9F%BA%E7%A1%80/5%E5%87%BD%E6%95%B0%E5%92%8C%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">
										5函数和正则表达式
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%9F%BA%E7%A1%80/6sed/">
										6sed
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%9F%BA%E7%A1%80/7gawk/">
										7gawk
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Shell实战
									</a>
									
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%AE%9E%E6%88%98/gawk%E5%AE%9E%E6%88%98/">
										gawk实战
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%AE%9E%E6%88%98/sed%E5%AE%9E%E6%88%98/">
										sed实战
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%AE%9E%E6%88%98/%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%A1%B9%E7%9B%AE/">
										字符串项目
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/Shell/Shell%E5%AE%9E%E6%88%98/%E7%B3%BB%E7%BB%9F%E5%B7%A1%E6%A3%80/">
										系统巡检
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C/">
										复杂网络
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/2021/01/17/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E7%AF%87%E5%8D%9A%E5%AE%A2/">
										我的第一篇博客
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title">

	服务(systemd)
</h1>
<div class="article-meta">
	
	<span>Rrigyouu</span>
	<span>2021-01-17 01:20:40</span>
    
		<div id="article-categories">
            
		</div>
    
</div>

<div id="article-content">
	<h3 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h3><p>Centos管理服务通常采用service和systemctl两种方式。</p>
<h4 id="service命令"><a href="#service命令" class="headerlink" title="service命令"></a>service命令</h4><p>service命令，移动到/etc/init.d/目录下，执行相关程序。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动redis服务</span></span><br><span class="line">service redis start</span><br><span class="line"><span class="meta">#</span><span class="bash"> 等价于</span></span><br><span class="line">/etc/init.d/redis start</span><br><span class="line"><span class="meta">#</span><span class="bash"> 其中，需要自己实现脚本</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="systemctl命令"><a href="#systemctl命令" class="headerlink" title="systemctl命令"></a>systemctl命令</h4><p>现在统一通过systemd管理service，提高并发。</p>
<p>常用操作：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动kafka服务</span></span><br><span class="line">systemctl start kafka</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入自启动服务，实际上只是添加了一条/etc/systemd/system/软连接指向service</span></span><br><span class="line">systemctl enable kafka</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看kafka服务状态</span></span><br><span class="line">systemctl status kafka</span><br><span class="line"><span class="meta">#</span><span class="bash"> 关闭kafka服务</span></span><br><span class="line">systemctl stop kafka</span><br><span class="line"><span class="meta">#</span><span class="bash"> 重新加载systemctl</span></span><br><span class="line">systemctl daemon-reload</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看kafka服务文件</span></span><br><span class="line">systemctl cat kafka</span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务文件目录地址</span></span><br><span class="line">ls -al /usr/lib/systemd/system/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有服务</span></span><br><span class="line">systemctl list-units --type=service --all</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="systemctl状态"><a href="#systemctl状态" class="headerlink" title="systemctl状态"></a>systemctl状态</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看zookeeper状态</span></span><br><span class="line">systemctl status zookeeper</span><br><span class="line"><span class="meta">#</span><span class="bash"> 返回结果</span></span><br><span class="line">● zookeeper.service - Apache Zookeeper server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/zookeeper.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Wed 2021-03-03 15:47:22 CST; 1h 24min ago</span><br><span class="line"> Main PID: 4673 (java)</span><br><span class="line">   CGroup: /system.slice/zookeeper.service</span><br><span class="line">           └─4673 java -Dzookeeper.log.dir=/opt/zookeeper/bin/../logs -Dzookeeper.log.file=zookeeper-kafka-server-loc...</span><br><span class="line"></span><br><span class="line">Mar 03 15:47:21 localhost.localdomain systemd[1]: Starting Apache Zookeeper server...</span><br><span class="line">Mar 03 15:47:21 localhost.localdomain zkServer.sh[4655]: /usr/bin/java</span><br><span class="line">Mar 03 15:47:21 localhost.localdomain zkServer.sh[4655]: ZooKeeper JMX enabled by default</span><br><span class="line">Mar 03 15:47:21 localhost.localdomain zkServer.sh[4655]: Using config: /opt/zookeeper/bin/../conf/zoo.cfg</span><br><span class="line">Mar 03 15:47:22 localhost.localdomain systemd[1]: Started Apache Zookeeper server.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>选择项</th>
<th>状态</th>
</tr>
</thead>
<tbody><tr>
<td>第二行Loaded</td>
<td>该服务是否开机启动<br />第一个enabled代表当前开机启动<br />第二个vendor preset代表安装该服务时默认开机不启动</td>
</tr>
<tr>
<td>第三行Active</td>
<td>该服务运行状态，有三个状态<br />active：正在运行<br />dead：没有运行<br />failed：运行失败（注意，该运行状态以启动脚本的退出状态为准，下面详细说明）</td>
</tr>
</tbody></table>
<h4 id="service文件"><a href="#service文件" class="headerlink" title="service文件"></a>service文件</h4><p>先看写的两个服务，zookeeper和kafka服务内容。</p>
<h5 id="zookeeper-service"><a href="#zookeeper-service" class="headerlink" title="zookeeper.service"></a>zookeeper.service</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Apache Zookeeper server</span><br><span class="line">Requires=network.target</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/var/lib/zookeeper/zookeeper_server.pid</span><br><span class="line">ExecStart=/opt/zookeeper/bin/zkServer.sh start</span><br><span class="line">ExecStop=/opt/zookeeper/bin/zkServer.sh stop</span><br><span class="line">ExecReload=/opt/zookeeper/bin/zkServer.sh restart</span><br><span class="line">Restart=on-failure</span><br><span class="line">User=kafka</span><br><span class="line">Group=kafka</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">SuccessExitStatus=143</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="kafka-service"><a href="#kafka-service" class="headerlink" title="kafka.service"></a>kafka.service</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=Apache Kafka Server</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/opt/kafka/bin/kafka-server-start.sh /opt/kafka/config/server.properties</span><br><span class="line">ExecStop=/opt/kafka/bin/kafka-server-stop.sh</span><br><span class="line">ExecReload=/opt/kafka/bin/kafka-server-start.sh /opt/kafka/config/server.properties</span><br><span class="line">Restart=on-failure</span><br><span class="line">User=kafka</span><br><span class="line">Group=kafka</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">SuccessExitStatus=143</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="service文件详解"><a href="#service文件详解" class="headerlink" title="service文件详解"></a>service文件详解</h5><table>
<thead>
<tr>
<th>Unit</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Unit</td>
<td>该项的依赖设置</td>
</tr>
<tr>
<td>Description</td>
<td>描述</td>
</tr>
<tr>
<td>Documentation</td>
<td>查询文档，一般可以放网址</td>
</tr>
<tr>
<td>After</td>
<td>在哪个服务后进行启动，不做强制要求</td>
</tr>
<tr>
<td>Before</td>
<td>在哪个服务前进行启动，不做强制要求</td>
</tr>
<tr>
<td>Requires</td>
<td>该服务启动前，强制要求启动另外的服务</td>
</tr>
<tr>
<td>Wants</td>
<td>该服务启动后，前置要求启动下一条服务，不会影响服务本身</td>
</tr>
<tr>
<td>Conflicts</td>
<td>冲突服务</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Service</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>Type</td>
<td>启动方式，有四种：<br />simple默认，由ExecStart指令启动，常驻内存<br />forking，ExecStart启动后，重启一个子进程执行，父进程退出<br />oneshot，只启动一次，不常驻内存<br />dbus，去的D-Bus名称后才运行，需要设置BusName<br />idle，所有执行工作顺利执行后才会执行该项</td>
</tr>
<tr>
<td>EnvironmentFile</td>
<td>环境配置文件<br />也可以Environment=后面接多个shell</td>
</tr>
<tr>
<td>ExecStartPre</td>
<td>实际启动前</td>
</tr>
<tr>
<td>ExecStartPost</td>
<td>实际启动后</td>
</tr>
<tr>
<td>ExecStart</td>
<td>启动脚本，执行systemctl start</td>
</tr>
<tr>
<td>ExecStop</td>
<td>停止脚本，执行systemctl stop</td>
</tr>
<tr>
<td>ExecReload</td>
<td>重载脚本，执行systemctl reload</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Install</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>WantedBy</td>
<td>这个服务挂载在那个target unit后面，一般后面接multi-user.target</td>
</tr>
<tr>
<td>Also</td>
<td>当前 unit 本身被 enable 时，Also 后面接的 unit 也会 enable</td>
</tr>
<tr>
<td>Alias</td>
<td>链接别名</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>Service</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>SuccessExitStatus=143</td>
<td>当退出状态码为143时，按照退出状态码0进行处理</td>
</tr>
</tbody></table>
<h5 id="service注意项"><a href="#service注意项" class="headerlink" title="service注意项"></a>service注意项</h5><ol>
<li><p>Type=forking：下面一行文件通常需要加上PIDFile文件，通常这个文件在服务启动时生成，结束时删除，文件里面写了pid编号。文件目录可能在/run下，或者config文件同级别文件中。如Zookeeper的pidfile，就在zookeeper的数据目录中。而数据目录写在配置文件中。</p>
</li>
<li><p>为什么对于kafka进行Type=simple处理？因为没有找到pid文件，直接使用Type=forking，systemctl会启动kafka-server-start.sh，让这个脚本再执行一个子进程，然后关闭父进程。但是，kafka-server-start.sh这个脚本启动后就不会再开一个子进程了，这也导致如果设置为forking，systemctl启动会直接卡住。</p>
</li>
</ol>
<h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><ol>
<li>systemd 取消了以前的 runlevel 概念，转而使用不同的 target 操作环境。常见操作环境为 multi-user.targer 与 graphical.target。 不重新开机而转不同的操作环境使用 systemctl isolate unit.target，而设置默认环境则使用 systemctl set-default unit.target。</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 某些定制化Linux系统仍没有采用systemd管理服务，仍然是service</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 因此，可以在/etc/rc.d 下看到运行等级</span></span><br><span class="line">ls /etc/rc.d/</span><br><span class="line">init.d/  rc0.d/  rc1.d/  rc2.d/  rc3.d/  rc4.d/  rc5.d/  rc6.d/  rc.local</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>定时服务可以采用crond，或者可以用systemd的timer模块，与systemd的相关修改信息都会log，推荐用systemd得到timer进行修改。具体操作可参考：<a target="_blank" rel="noopener" href="https://wizardforcel.gitbooks.io/vbird-linux-basic-4e/content/151.html">https://wizardforcel.gitbooks.io/vbird-linux-basic-4e/content/151.html</a></li>
</ol>

</div>


    <div class="post-guide">
        <div class="item left">
            
              <a href="/2021/01/17/Redis/Redis%E5%8F%82%E6%95%B0/">
                  <i class="fa fa-angle-left" aria-hidden="true"></i>
                  Redis参数
              </a>
            
        </div>
        <div class="item right">
            
              <a href="/2021/01/17/Linux/%E9%98%B2%E7%81%AB%E5%A2%99(iptables)/">
                防火墙(iptables)
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>



	<div id="vcomments"></div>


<script>
	
		// 评论
		new Valine({
			av: AV,
			el: '#vcomments',
			notify: false,
			verify: false,
			path: window.location.pathname,
			appId: '',
			appKey: '',
			placeholder: '请输入评论',
			avatar: 'retro',
			recordIP: false
		})
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">Rrigyouu</a> 
	
	
		|
		<span id="busuanzi_container_site_pv">
			pv
			<span id="busuanzi_value_site_pv"></span>
		</span>
		|
		<span id="busuanzi_container_site_uv"> 
			uv
			<span id="busuanzi_value_site_uv"></span>
		</span>
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>